# DNS Configuration Metrics
# Generated by Ansible dns role
# Systemd version: {{ dns_systemd_version | default('unknown') }}

# HELP dns_enabled DNS role is enabled
# TYPE dns_enabled gauge
dns_enabled {{ 1 if dns_enabled else 0 }}

# HELP dns_resolved_enabled systemd-resolved is enabled
# TYPE dns_resolved_enabled gauge
dns_resolved_enabled {{ 1 if dns_resolved_enabled | default(true) else 0 }}

# HELP dns_dnssec_strict DNSSEC strict validation enabled
# TYPE dns_dnssec_strict gauge
dns_dnssec_strict {{ 1 if dns_dnssec | default('allow-downgrade') in ['yes', 'true', true] else 0 }}

# HELP dns_dnssec_allow_downgrade DNSSEC allow-downgrade mode
# TYPE dns_dnssec_allow_downgrade gauge
dns_dnssec_allow_downgrade {{ 1 if dns_dnssec | default('allow-downgrade') == 'allow-downgrade' else 0 }}

# HELP dns_over_tls_strict DNS over TLS required
# TYPE dns_over_tls_strict gauge
dns_over_tls_strict {{ 1 if dns_over_tls | default('opportunistic') in ['yes', 'true', true] else 0 }}

# HELP dns_over_tls_opportunistic DNS over TLS in opportunistic mode
# TYPE dns_over_tls_opportunistic gauge
dns_over_tls_opportunistic {{ 1 if dns_over_tls | default('opportunistic') == 'opportunistic' else 0 }}

# HELP dns_cache_enabled DNS cache enabled
# TYPE dns_cache_enabled gauge
dns_cache_enabled {{ 1 if dns_cache | default(true) else 0 }}

# HELP dns_llmnr_enabled LLMNR enabled (security risk)
# TYPE dns_llmnr_enabled gauge
dns_llmnr_enabled {{ 1 if dns_llmnr | default(false) else 0 }}

# HELP dns_mdns_enabled Multicast DNS enabled
# TYPE dns_mdns_enabled gauge
dns_mdns_enabled {{ 1 if dns_mdns | default(false) else 0 }}

# HELP dns_stub_listener_enabled Stub listener enabled
# TYPE dns_stub_listener_enabled gauge
dns_stub_listener_enabled {{ 1 if dns_stub_listener | default(true) else 0 }}

# HELP dns_servers_configured Number of primary DNS servers
# TYPE dns_servers_configured gauge
dns_servers_configured {{ dns_servers | default([]) | length }}

# HELP dns_fallback_servers_configured Number of fallback DNS servers
# TYPE dns_fallback_servers_configured gauge
dns_fallback_servers_configured {{ dns_fallback_servers | default([]) | length }}

# HELP dns_link_dns_interfaces Number of interfaces with per-link DNS
# TYPE dns_link_dns_interfaces gauge
dns_link_dns_interfaces {{ dns_link_dns | default([]) | length }}

# HELP dns_hosts_entries Number of custom /etc/hosts entries
# TYPE dns_hosts_entries gauge
dns_hosts_entries {{ dns_hosts_entries | default([]) | length }}

# HELP dns_systemd_version Detected systemd version
# TYPE dns_systemd_version gauge
dns_systemd_version {{ dns_systemd_version | default(0) }}
